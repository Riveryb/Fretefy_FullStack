<div class="container">
  <h2 class="page-title">{{ editingId ? 'Editar Região' : 'Cadastro de região' }}</h2>

  <form class="card form-card form-grid" [formGroup]="form" (ngSubmit)="salvar()">
    <!-- Nome -->
    <div>
      <label class="label">Nome da região *</label>
      <input class="input" type="text" formControlName="nome" placeholder="Ex.: Grande Curitiba">
      <div class="form-error" *ngIf="form.get('nome')?.touched && form.get('nome')?.hasError('required')">
        Informe o nome.
      </div>
      <div class="form-error" *ngIf="form.get('nome')?.hasError('nomeDuplicado')">
        Já existe uma região com esse nome.
      </div>
    </div>

    <!-- Cidades -->
    <div>
      <label class="label">Locais da região</label>
      <div *ngFor="let c of cidades.controls; let i = index" class="city-row" style="margin-bottom:10px;">
        <!-- seu componente de cidade como FormControl -->
        <app-cidade-select [formControl]="c"></app-cidade-select>

        <button type="button" class="btn btn-ghost" (click)="removeCidade(i)">
          Remover
        </button>
      </div>

      <button type="button" class="pill" (click)="addCidade()">
        <svg class="icon" viewBox="0 0 24 24" fill="none"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        Adicionar local
      </button>

      <div class="form-error" *ngIf="form.get('cidades')?.touched && form.get('cidades')?.hasError('atLeastOneCity')">
        Informe ao menos uma cidade.
      </div>
      <div class="form-error" *ngIf="form.get('cidades')?.hasError('duplicateCities')">
        Não repita cidades.
      </div>
    </div>

    <!-- Ações -->
    <div class="form-actions">
      <button type="button" class="btn btn-cancel" (click)="cancelar()">Cancelar</button>
      <button type="submit" class="btn btn-save">Salvar</button>
    </div>

    <div class="form-error" *ngIf="errorMsg">{{ errorMsg }}</div>
  </form>
</div>
